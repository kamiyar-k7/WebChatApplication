@inherits LayoutComponentBase
@inject NavigationManager _navmanager
@inject IHomePageServcies _homeservices

<MudThemeProvider />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />


<MudLayout>


    <MudAppBar>
        <MudGrid Class="d-flex align-items-center">
            <MudItem>
                <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@(() => DrawerButton())" />
                Web Chat
            </MudItem>

            <MudSpacer /> <!-- This will push the next MudItem to the right -->

            <MudItem Class="d-flex align-items-center justify-content-end">
                <MudTextField @bind-Value="UserName"
                              Placeholder="Search UserNames"
                              Variant="Variant.Outlined"
                              Adornment="Adornment.End"
                              AdornmentIcon="@Icons.Material.Filled.Search"
                              OnAdornmentClick="SearchUsers"
                              Class="white-text"
                              />
            </MudItem>
        </MudGrid>
    </MudAppBar>


    <MudDrawer @bind-Open="@opendrawer" Class="white-text" Style="background-color:rgba(89, 74, 226, 1);">



        <MudNavMenu Class="mt-1">

            <MudNavLink Href="/" Match="NavLinkMatch.All">Home</MudNavLink>
            <MudNavLink Href="/" Match="NavLinkMatch.Prefix">My Profile</MudNavLink>

            <MudNavGroup Title="check">

                <MudNavLink Href="/" Match="NavLinkMatch.Prefix">Settings</MudNavLink>
                <MudNavLink Href="/" Match="NavLinkMatch.Prefix" Class="text-danger">LogOut</MudNavLink>

            </MudNavGroup>

            <MudNavLink Match="NavLinkMatch.Prefix">Theme</MudNavLink>

            <MudNavLink Href="/" Match="NavLinkMatch.Prefix">About</MudNavLink>

        </MudNavMenu>
    </MudDrawer>

    @if (!string.IsNullOrEmpty(UserName) )
    {
        <SearchUsers Model="@model" />
    }
    else
    {
        <MudMainContent Class="bg-dark">
            @Body
        </MudMainContent>
    }



</MudLayout>

@code {

    public string UserName = string.Empty;
    bool opendrawer = false;
    private int id;
    private List<UserSearchDto> model = new();

    void DrawerButton()
    {
        opendrawer = !opendrawer;
    }

    private async Task SearchUsers()
    {
        model = await _homeservices.SerchUsers(UserName);
      
    }

    void OpenChat(int id)
    {

        _navmanager.NavigateTo($"chatpage/{id}");
    }


}






